---

  - name: Clone dotfiles git repository
    git:
      repo: https://github.com/patkaehuaea/dotfiles.git
      # Ansible will create this directory if it
      # doesn't already exist.
      dest: "{{ DOTFILES }}"

  - name: Create directories
    file:
      path: "{{ HOME }}/{{ item.path }}"
      state: directory
      mode: '{{ item.mode }}'
    with_filetree: "{{ DOTFILES_HOMEDIR }}"
    when: item.state == 'directory'

  - name: Create symlinks
    file:
      src: '{{ item.src }}'
      dest: '{{ HOME }}/{{ item.path }}'
      state: link
      force: yes
      mode: '{{ item.mode }}'
    with_filetree: "{{ DOTFILES_HOMEDIR }}"
    when: item.state == 'file'
